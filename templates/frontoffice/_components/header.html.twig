<!-- HEADER LG -->
<!-- Mode desktop -->
<style>
    .triangle,
    .small-triangle {
        position: absolute;
        bottom: 0;
        left: 50%;
        transform: translateX(0%);
        width: 0;
        height: 0;
        border-style: solid;
    }

    .triangle {
        border-width: 10px 10px 0;
        top:21px;
        border-color: #000 transparent transparent transparent; /* Couleur du triangle */
    }

    .small-triangle {
        border-width: 10px 10px 0;
        top:20px;
        border-color: #fff transparent transparent transparent; /* Couleur du petit triangle */
    }
</style>
<div class="container-fluid d-none d-lg-block" style="margin-top:35px">
    <div class="row">
        <div class="col-3">
            <div style="padding-left: 30px">
                <a href="{{ path('fo_home_index') }}">
                    <img style="max-width: 234px" src="{{ asset(getSiteImagePath('LOGO_HEADER.svg')) }}" alt="la_lune_logo">
                </a>
            </div>
        </div>
        <div class="col-9">
            <!-- Boutons galerie et Bouton Menu -->
            <div style="padding-right: 30px">
                <div class="d-flex justify-content-end align-items-center">
                    {% set count_header = 0  %}
                    {% for article_datas in gallery_articles_header %}
                        {% if article_datas['photos'] != null %}
                            {% for photo in article_datas['photos'] %}
                                {% if loop.index == 1 %}
                                    {% set count_header = count_header + 1  %}
                                    <div style="z-index: {{ 1000 - count_header }}">
                                        <a
                                                class="text-decoration-none"
                                                href="{{ url('ressources_image', {'width':'src','height':'src', 'media':photo.media}) }}"
                                                data-lightbox="image-header-{{ loop.parent.loop.index0 }}"
                                                data-title="{{ article_datas['article'].title ~ ' - ' ~ article_datas['article'].dateEvent | date("d/m/Y")  }}"
                                        >
                                            {% set longueurMax = 10 %}
                                            <img src="{{ url('ressources_image', {'width':'small','height':'small', 'media':photo.media} ) }}" class=" rounded-circle round-img-header">
                                            {% if article_datas['article'].titleByLanguage|length > longueurMax %}

                                                <div class="text-center header-gallery-art" style="font-size: 12px">{{ article_datas['article'].dateEvent | date('d/m') }} </div>
                                                <div class="text-center header-gallery-art" style="font-size: 12px">{{ article_datas['article'].titleByLanguage|slice(0, longueurMax) ~ '...' }}</div>
                                            {% else %}
                                                <div class="text-center header-gallery-art" style="font-size: 12px">{{ article_datas['article'].dateEvent | date('d/m') }} </div>
                                                <div class="text-center header-gallery-art" style="font-size: 12px">{{ article_datas['article'].titleByLanguage }}</div>
                                            {% endif %}
                                        </a>
                                    </div>
                                {% else %}
                                    <a
                                        href="{{ url('ressources_image', {'width':'src','height':'src', 'media':photo.media}) }}"
                                        data-lightbox="image-header-{{ loop.parent.loop.index0 }}"
                                        data-title="{{ article_datas['article'].title ~ ' - ' ~ article_datas['article'].dateEvent | date("d/m/Y")  }}"
                                    ></a>
                                {% endif %}
                            {% endfor %}
                        {% endif %}
                    {% endfor %}
                    <a href="{{ path('gallery') }}" class="ms-2 text-decoration-none position-relative" style="padding-bottom: 30px; display: inline-block;">
                        <img style="width: 62px; height: 62px; margin-left: -24px;" src="{{ asset(getSiteImagePath('header-galerie.svg')) }}" alt="Accès à la galerie">
                        <div style="position: absolute; top: -35px; left: 0px; transform: translateX(-50%); text-align: center; font-size: 14px;  width:190px">
                            <div style="border-bottom: solid black 1px; display: inline-block; position: relative;">
                                Galerie Photos
                            </div>
                            <div class="triangle">
                            </div>
                            <div class="small-triangle"></div>
                        </div>
                    </a>
                    <a rel="nofollow" href="https://billetterie.lalune.net/"  class="ms-2 text-decoration-none" style="padding-bottom: 30px">
                        <img style="width: 62px" src="{{ asset(getSiteImagePath('picto-billet.svg')) }}">
                    </a>
                </div>
            </div>
            <div>

            </div>
            <nav class="navbar navbar-expand-lg mt-auto px-lg-5">
                <ul class="navbar-nav w-100 justify-content-end pt-3 px-lg-5">
                </ul>
            </nav>
            <!-- Menu avec dropdowns -->
            <div class="d-none justify-content-end d-lg-flex block navbar-expand-lg col-12" style="padding-right: 30px">
                <div class="row row-cols-auto">
                    {% for url, category_header in menu_category_datas %}
                        <div class="px-4 col {% if loop.index0 != 0 %} border-dotted-black {% endif %}menu-header-item {% if  (page_title | upper) == (category_header.title|upper) %}active{% endif %}">
                            {% do category_header.getDatas(locale) %}
                                {# Soutien aux artistes, Projets culturels, Infos pratiques #}
                                {% if category_header.id == 6 or category_header.id == 53 or category_header.id == 39 %}
                                    <div class="dropdown">
                                        <a class="dropdown-toggle text-decoration-none fs-4" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                            {{ category_header.title|upper }}
                                        </a>
                                        <ul class="dropdown-menu">
                                            {# Projets culturels #}
                                            {% if category_header.id == 53  %}
                                                <li><a class="dropdown-item dropdown-select-item-li text-decoration-none black fs-4" href="{{ path(url ~ category_header.url) }}">{{ category_header.title|upper }} - INDEX</a></li>
                                            {% endif %}
                                            {# Infos pratiques #}
                                            {% if category_header.id == 39 %}
                                                {% for contact_entry in contact_entries %}
                                                    <li><a class="dropdown-item dropdown-select-item-li text-decoration-none black fs-4" href="{{ path('fo_infos_contact', {'entrySlug': contact_entry.slug }) }}">{{ contact_entry.title|upper }}</a></li>
                                                {% endfor %}
                                            {% else %}
                                                {% for sous_categorie in category_header.children %}
                                                    {%  if sous_categorie.online %}
                                                        {# Soutien aux artistes, projets culturels #}
                                                        {% if category_header.id in  [6,53] %}
                                                            <li><a class="dropdown-item dropdown-select-item-li text-decoration-none black fs-4" href="{{ path(url ~ sous_categorie.url) }}#{{ sous_categorie.slug }}">{{ sous_categorie.title|upper }}</a></li>
                                                        {% endif %}
                                                    {% endif %}
                                                {% endfor %}
                                            {% endif %}


                                        </ul>
                                    </div>
                                {% else %}
                                    <a class="text-decoration-none black fs-4"  href="{{ path(url) }}">{{ category_header.title|upper }}</a>
                                {% endif %}
                        </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
</div>

<!-- HEADER MD/SM -->

<div class="d-lg-none container-fluid" style="margin-top:24px; margin-bottom: 20px">
    <div class="row">
        <div class="col-3">
            <a href="{{ path('fo_home_index') }}">
                <img style="" src="{{ asset(getSiteImagePath('LOGO_HEADER.svg')) }}">
            </a>
        </div>
        <div class="col-9 d-flex justify-content-end align-items-center">

            <a href="{{ path('gallery') }}"  class="ms-2 text-decoration-none">
                <img style="width: 44px" src="{{ asset(getSiteImagePath('header-galerie.svg')) }}">
            </a>
            <a rel="nofollow" href="https://billetterie.lalune.net/"  class="ms-2 text-decoration-none">
                <img style="width: 44px" src="{{ asset(getSiteImagePath('picto-billet.svg')) }}">
            </a>
            <button class="btn p-0 ms-2" style=""  type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasRight" aria-controls="offcanvasRight">
                <img style="width: 44px" src="{{ asset(getSiteImagePath('header-menu.svg')) }}">
            </button>
        </div>
    </div>
</div>
<div class="offcanvas offcanvas-end" data-bs-scroll="true" tabindex="-1" id="offcanvasRight" aria-labelledby="offcanvasRightLabel">
    <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="staticBackdropLabel"></h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body">
        <nav class="navbar navbar-dark py-0" style="color: black;">
            <ul class="navbar-nav w-100">
                <!-- Catégorie du menu -->
                <li class="nav-item border-y ps-3">
                    <div class="nav-link fs-3" href=""><a class="text-decoration-none" style="color: black" href="/home">> ACCUEIL</a></div>
                    <hr>
                    {% for url, category in menu_category_datas %}
                        <div class="nav-link fs-3" href=""><a class="text-decoration-none" style="color: black" href="{{ path(url) }}">> {{ category.title|upper }}</a></div>
                        {% for sous_categories in category.children %}

                            {% if category.id == 6 %}
                                <div class="ps-5 nav-link fs-6" href=""><a class="text-decoration-none fermer-canvas" href="{{ path(url ~ sous_categories.url) }}#{{ sous_categories.title }}">> {{ sous_categories.title|upper }}</a></div>
                            {% elseif category.id == 53 %}
                                <div class="ps-5 nav-link fs-6" href=""><a class="text-decoration-none fermer-canvas" href="{{ path(url ~ sous_categories.url) }}{{ sous_categories.title }}">> {{ sous_categories.title|upper }}</a></div>
                            {% elseif category.id == 39 %}
                                {% if loop.index != 1 %}
                                    <div class="ps-5 nav-link fs-6" href=""><a class="text-decoration-none fermer-canvas" {% if loop.index0 != 0 %} href="{{ path('fo_infos_contact', {'entry': 'entry' ~ loop.index0 }) }}"{% else %} href="{{ path('fo_infos_contact', {'entry': 'entry5' }) }}"{% endif %}>> {{ sous_categories.title|upper }}</a></div>
                                {% endif %}
                            {% endif %}
                        {% endfor %}
                        {% for sous_categories in category.children %}
                            {% if category.id == 39 %}
                                {% if loop.index == 1 %}
                                    <div class="ps-5 nav-link fs-6" href=""><a class="text-decoration-none fermer-canvas" {% if loop.index0 != 0 %} href="{{ path('fo_infos_contact', {'entry': 'entry' ~ loop.index0 }) }}"{% else %} href="{{ path('fo_infos_contact', {'entry': 'entry5' }) }}"{% endif %}>> {{ sous_categories.title|upper }}</a></div>
                                {% endif %}
                            {% endif %}
                        {% endfor %}
                        {% if not loop.last %}
                            <hr>
                        {% endif %}
                    {% endfor %}
                </li>
            </ul>
        </nav>

    </div>
</div>
<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>

<script>
    // Ajoutez un écouteur d'événements "click" à tous les éléments <a> avec la classe "fermer-canvas"
    $('.fermer-canvas').on('click', function () {
        // Sélectionnez le canvas par son ID
        let offcanvasRight = $('#offcanvasRight');
        let offcanvasFade = $('.offcanvas-backdrop');
        offcanvasRight.removeClass('show');
        offcanvasFade.removeClass('show');

    });
</script>